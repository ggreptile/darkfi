<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Key manipulation functions for use with public keys."><title>tor_llcrypto::pk::keymanip - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../../static.files/rustdoc-cb6f1f67f1bcd037.css" id="mainThemeStyle"><meta name="rustdoc-vars" data-root-path="../../../" data-static-root-path="../../../static.files/" data-current-crate="tor_llcrypto" data-themes="" data-resource-suffix="" data-rustdoc-version="1.73.0-nightly (31395ec38 2023-07-24)" data-channel="nightly" data-search-js="search-6dfdfced5eff6596.js" data-settings-js="settings-de11bff964e9d4e5.js" data-settings-css="settings-8c76f75bfb6bd192.css" data-theme-light-css="light-6d2c9675f3d09c26.css" data-theme-dark-css="dark-45ceb8f2e522f4d1.css" data-theme-ayu-css="ayu-fd19013d6ce078bf.css" ><script src="../../../static.files/storage-db41da1a38ea3cb8.js"></script><script defer src="../../../static.files/main-0795b7d26be81095.js"></script><noscript><link rel="stylesheet" media="(prefers-color-scheme:light)" href="../../../static.files/light-6d2c9675f3d09c26.css"><link rel="stylesheet" media="(prefers-color-scheme:dark)" href="../../../static.files/dark-45ceb8f2e522f4d1.css"><link rel="stylesheet" href="../../../static.files/noscript-cffde32267a19fd6.css"></noscript><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../../../tor_llcrypto/index.html"><img class="rust-logo" src="../../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../../../tor_llcrypto/index.html"><img class="rust-logo" src="../../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">Module keymanip</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#reexports">Re-exports</a></li><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#functions">Functions</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Module <a href="../../index.html">tor_llcrypto</a>::<wbr><a href="../index.html">pk</a>::<wbr><a class="mod" href="#">keymanip</a><button id="copy-path" title="Copy item path to clipboard"><img src="../../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="src" href="../../../src/tor_llcrypto/pk/keymanip.rs.html#1-552">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Key manipulation functions for use with public keys.</p>
<p>Tor does some interesting and not-standard things with its
curve25519 and ed25519 keys, for several reasons.</p>
<p>In order to prove ownership of a curve25519 private key, Tor
converts it into an ed25519 key, and then uses that ed25519 key to
sign its identity key.  We implement this conversion with
<a href="fn.convert_curve25519_to_ed25519_public.html" title="fn tor_llcrypto::pk::keymanip::convert_curve25519_to_ed25519_public"><code>convert_curve25519_to_ed25519_public</code></a> and
<a href="fn.convert_curve25519_to_ed25519_private.html" title="fn tor_llcrypto::pk::keymanip::convert_curve25519_to_ed25519_private"><code>convert_curve25519_to_ed25519_private</code></a>.</p>
<p>In Tor’s v3 onion service design, Tor uses a <em>key blinding</em>
algorithm to derive a publicly known Ed25519 key from a different
Ed25519 key used as the .onion address.  This algorithm allows
directories to validate the signatures on onion service
descriptors, without knowing which services they represent.  We
implement this blinding operation via <a href="fn.blind_pubkey.html" title="fn tor_llcrypto::pk::keymanip::blind_pubkey"><code>blind_pubkey</code></a>.</p>
<h3 id="todo"><a href="#todo">TODO</a></h3>
<p>Recommend more standardized ways to do these things.</p>
</div></details><h2 id="reexports" class="small-section-header"><a href="#reexports">Re-exports</a></h2><ul class="item-table"><li><div class="item-name" id="reexport.ExpandedKeypair"><code>pub use pk::ed25519::<a class="struct" href="../ed25519/struct.ExpandedKeypair.html" title="struct tor_llcrypto::pk::ed25519::ExpandedKeypair">ExpandedKeypair</a>;</code></div></li></ul><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.ExpandedSecretKey.html" title="struct tor_llcrypto::pk::keymanip::ExpandedSecretKey">ExpandedSecretKey</a></div><div class="desc docblock-short">An “expanded” secret key.</div></li><li><div class="item-name"><a class="struct" href="struct.Keypair.html" title="struct tor_llcrypto::pk::keymanip::Keypair">Keypair</a></div><div class="desc docblock-short">An ed25519 keypair.</div></li><li><div class="item-name"><a class="struct" href="struct.PublicKey.html" title="struct tor_llcrypto::pk::keymanip::PublicKey">PublicKey</a></div><div class="desc docblock-short">An ed25519 public key.</div></li><li><div class="item-name"><a class="struct" href="struct.SecretKey.html" title="struct tor_llcrypto::pk::keymanip::SecretKey">SecretKey</a></div><div class="desc docblock-short">An EdDSA secret key.</div></li><li><div class="item-name"><a class="struct" href="struct.Signature.html" title="struct tor_llcrypto::pk::keymanip::Signature">Signature</a></div><div class="desc docblock-short">Ed25519 signature.</div></li></ul><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2><ul class="item-table"><li><div class="item-name"><a class="enum" href="enum.BlindingError.html" title="enum tor_llcrypto::pk::keymanip::BlindingError">BlindingError</a></div><div class="desc docblock-short">An error occurred during a key-blinding operation.</div></li></ul><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2><ul class="item-table"><li><div class="item-name"><a class="fn" href="fn.blind_keypair.html" title="fn tor_llcrypto::pk::keymanip::blind_keypair">blind_keypair</a></div><div class="desc docblock-short">Blind the ed25519 secret key <code>sk</code> using the blinding factor <code>h</code>, and
return the blinded secret key.</div></li><li><div class="item-name"><a class="fn" href="fn.blind_pubkey.html" title="fn tor_llcrypto::pk::keymanip::blind_pubkey">blind_pubkey</a></div><div class="desc docblock-short">Blind the ed25519 public key <code>pk</code> using the blinding factor
<code>h</code>, and return the blinded public key.</div></li><li><div class="item-name"><a class="fn" href="fn.convert_curve25519_to_ed25519_private.html" title="fn tor_llcrypto::pk::keymanip::convert_curve25519_to_ed25519_private">convert_curve25519_to_ed25519_private</a></div><div class="desc docblock-short">Convert a curve25519 private key to an ed25519 private key (and
give a sign bit) to use with it, for use in ntor key cross-certification.</div></li><li><div class="item-name"><a class="fn" href="fn.convert_curve25519_to_ed25519_public.html" title="fn tor_llcrypto::pk::keymanip::convert_curve25519_to_ed25519_public">convert_curve25519_to_ed25519_public</a></div><div class="desc docblock-short">Convert a curve25519 public key (with sign bit) to an ed25519
public key, for use in ntor key cross-certification.</div></li><li><div class="item-name"><a class="fn" href="fn.convert_ed25519_to_curve25519_private.html" title="fn tor_llcrypto::pk::keymanip::convert_ed25519_to_curve25519_private">convert_ed25519_to_curve25519_private</a></div><div class="desc docblock-short">Convert an ed25519 private key to a curve25519 private key.</div></li></ul></section></div></main></body></html>