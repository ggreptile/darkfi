<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Multi-hop paths over the Tor network."><title>tor_proto::circuit - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-cb6f1f67f1bcd037.css" id="mainThemeStyle"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="tor_proto" data-themes="" data-resource-suffix="" data-rustdoc-version="1.73.0-nightly (31395ec38 2023-07-24)" data-channel="nightly" data-search-js="search-6dfdfced5eff6596.js" data-settings-js="settings-de11bff964e9d4e5.js" data-settings-css="settings-8c76f75bfb6bd192.css" data-theme-light-css="light-6d2c9675f3d09c26.css" data-theme-dark-css="dark-45ceb8f2e522f4d1.css" data-theme-ayu-css="ayu-fd19013d6ce078bf.css" ><script src="../../static.files/storage-db41da1a38ea3cb8.js"></script><script defer src="../../static.files/main-0795b7d26be81095.js"></script><noscript><link rel="stylesheet" media="(prefers-color-scheme:light)" href="../../static.files/light-6d2c9675f3d09c26.css"><link rel="stylesheet" media="(prefers-color-scheme:dark)" href="../../static.files/dark-45ceb8f2e522f4d1.css"><link rel="stylesheet" href="../../static.files/noscript-cffde32267a19fd6.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../../tor_proto/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../../tor_proto/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">Module circuit</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#modules">Modules</a></li><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#constants">Constants</a></li><li><a href="#traits">Traits</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Module <a href="../index.html">tor_proto</a>::<wbr><a class="mod" href="#">circuit</a><button id="copy-path" title="Copy item path to clipboard"><img src="../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="src" href="../../src/tor_proto/circuit.rs.html#1-1728">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Multi-hop paths over the Tor network.</p>
<p>Right now, we only implement “client circuits” – also sometimes
called “origin circuits”.  A client circuit is one that is
constructed by this Tor instance, and used in its own behalf to
send data over the Tor network.</p>
<p>Each circuit has multiple hops over the Tor network: each hop
knows only the hop before and the hop after.  The client shares a
separate set of keys with each hop.</p>
<p>To build a circuit, first create a <a href="../channel/struct.Channel.html" title="struct tor_proto::channel::Channel">crate::channel::Channel</a>, then
call its <a href="../channel/struct.Channel.html#method.new_circ" title="method tor_proto::channel::Channel::new_circ">crate::channel::Channel::new_circ</a> method.  This yields
a <a href="struct.PendingClientCirc.html" title="struct tor_proto::circuit::PendingClientCirc">PendingClientCirc</a> object that won’t become live until you call
one of the methods that extends it to its first hop.  After you’ve
done that, you can call <a href="struct.ClientCirc.html#method.extend_ntor" title="method tor_proto::circuit::ClientCirc::extend_ntor">ClientCirc::extend_ntor</a> on the circuit to
build it into a multi-hop circuit.  Finally, you can use
<a href="struct.ClientCirc.html#method.begin_stream" title="method tor_proto::circuit::ClientCirc::begin_stream">ClientCirc::begin_stream</a> to get a Stream object that can be used
for anonymized data.</p>
<h2 id="implementation"><a href="#implementation">Implementation</a></h2>
<p>Each open circuit has a corresponding Reactor object that runs in
an asynchronous task, and manages incoming cells from the
circuit’s upstream channel.  These cells are either RELAY cells or
DESTROY cells.  DESTROY cells are handled immediately.
RELAY cells are either for a particular stream, in which case they
get forwarded to a RawCellStream object, or for no particular stream,
in which case they are considered “meta” cells (like EXTENDED2)
that should only get accepted if something is waiting for them.</p>
<h2 id="limitations"><a href="#limitations">Limitations</a></h2>
<p>This is client-only.</p>
<p>There’s one big mutex on the whole circuit: the reactor needs to hold
it to process a cell, and streams need to hold it to send.</p>
<p>There is no flow-control or rate-limiting or fairness.</p>
</div></details><h2 id="modules" class="small-section-header"><a href="#modules">Modules</a></h2><ul class="item-table"><li><div class="item-name"><a class="mod" href="handshake/index.html" title="mod tor_proto::circuit::handshake">handshake</a></div><div class="desc docblock-short">Features for manual invocation of Tor’s cryptographic circuit handshakes.</div></li></ul><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.CircParameters.html" title="struct tor_proto::circuit::CircParameters">CircParameters</a></div><div class="desc docblock-short">Description of the network’s current rules for building circuits.</div></li><li><div class="item-name"><a class="struct" href="struct.ClientCirc.html" title="struct tor_proto::circuit::ClientCirc">ClientCirc</a></div><div class="desc docblock-short">A circuit that we have constructed over the Tor network.</div></li><li><div class="item-name"><a class="struct" href="struct.Path.html" title="struct tor_proto::circuit::Path">Path</a></div><div class="desc docblock-short">A circuit’s path through the network.</div></li><li><div class="item-name"><a class="struct" href="struct.PathEntry.html" title="struct tor_proto::circuit::PathEntry">PathEntry</a></div><div class="desc docblock-short">A description of a single hop in a <a href="struct.Path.html" title="struct tor_proto::circuit::Path"><code>Path</code></a>.</div></li><li><div class="item-name"><a class="struct" href="struct.PendingClientCirc.html" title="struct tor_proto::circuit::PendingClientCirc">PendingClientCirc</a></div><div class="desc docblock-short">A ClientCirc that needs to send a create cell and receive a created* cell.</div></li><li><div class="item-name"><a class="struct" href="struct.UniqId.html" title="struct tor_proto::circuit::UniqId">UniqId</a></div><div class="desc docblock-short">Process-unique identifier for a circuit.</div></li></ul><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2><ul class="item-table"><li><div class="item-name"><a class="enum" href="enum.MetaCellDisposition.html" title="enum tor_proto::circuit::MetaCellDisposition">MetaCellDisposition</a></div><div class="desc docblock-short">A possible successful outcome of giving a message to a <a href="trait.MsgHandler.html" title="trait tor_proto::circuit::MsgHandler"><code>MsgHandler</code></a>.</div></li></ul><h2 id="constants" class="small-section-header"><a href="#constants">Constants</a></h2><ul class="item-table"><li><div class="item-name"><a class="constant" href="constant.CIRCUIT_BUFFER_SIZE.html" title="constant tor_proto::circuit::CIRCUIT_BUFFER_SIZE">CIRCUIT_BUFFER_SIZE</a></div><div class="desc docblock-short">The size of the buffer for communication between <code>ClientCirc</code> and its reactor.</div></li></ul><h2 id="traits" class="small-section-header"><a href="#traits">Traits</a></h2><ul class="item-table"><li><div class="item-name"><a class="trait" href="trait.MsgHandler.html" title="trait tor_proto::circuit::MsgHandler">MsgHandler</a></div><div class="desc docblock-short">An object that checks whether incoming control messages are acceptable on a
circuit, and delivers them to a client if so.</div></li></ul></section></div></main></body></html>