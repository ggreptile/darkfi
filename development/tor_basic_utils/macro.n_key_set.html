<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Declare a structure that can hold elements with multiple unique keys."><title>n_key_set in tor_basic_utils - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-cb6f1f67f1bcd037.css" id="mainThemeStyle"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="tor_basic_utils" data-themes="" data-resource-suffix="" data-rustdoc-version="1.73.0-nightly (31395ec38 2023-07-24)" data-channel="nightly" data-search-js="search-6dfdfced5eff6596.js" data-settings-js="settings-de11bff964e9d4e5.js" data-settings-css="settings-8c76f75bfb6bd192.css" data-theme-light-css="light-6d2c9675f3d09c26.css" data-theme-dark-css="dark-45ceb8f2e522f4d1.css" data-theme-ayu-css="ayu-fd19013d6ce078bf.css" ><script src="../static.files/storage-db41da1a38ea3cb8.js"></script><script defer src="sidebar-items.js"></script><script defer src="../static.files/main-0795b7d26be81095.js"></script><noscript><link rel="stylesheet" media="(prefers-color-scheme:light)" href="../static.files/light-6d2c9675f3d09c26.css"><link rel="stylesheet" media="(prefers-color-scheme:dark)" href="../static.files/dark-45ceb8f2e522f4d1.css"><link rel="stylesheet" href="../static.files/noscript-cffde32267a19fd6.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc macro"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../tor_basic_utils/index.html"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../tor_basic_utils/index.html"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><div class="sidebar-elems"><h2><a href="index.html">In tor_basic_utils</a></h2></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Macro <a href="index.html">tor_basic_utils</a>::<wbr><a class="macro" href="#">n_key_set</a><button id="copy-path" title="Copy item path to clipboard"><img src="../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="src" href="../src/tor_basic_utils/n_key_set.rs.html#97-574">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><pre class="rust item-decl"><span class="macro">macro_rules! </span>n_key_set {
    {
    $(<span class="attr">#[<span class="macro-nonterminal">$meta</span>:meta]</span>)*
    <span class="macro-nonterminal">$vis</span>:vis <span class="kw">struct </span><span class="macro-nonterminal">$mapname</span>:ident $(&lt;$(<span class="macro-nonterminal">$P</span>:ident),<span class="kw-2">*</span>&gt;)<span class="question-mark">? </span><span class="kw">for </span><span class="macro-nonterminal">$V</span>:ty
    $( <span class="kw">where </span>[ $(<span class="macro-nonterminal">$constr</span>:tt)+ ] )<span class="question-mark">?
    </span>{
        $(<span class="macro-nonterminal">$body</span>:tt)+
    }
} =&gt; { ... };
    {
        $(<span class="attr">#[<span class="macro-nonterminal">$meta</span>:meta]</span>)*
        <span class="macro-nonterminal">$vis</span>:vis <span class="kw">struct </span>[$($(<span class="macro-nonterminal">$G</span>:tt)+)<span class="question-mark">?</span>] <span class="macro-nonterminal">$mapname</span>:ident [$($(<span class="macro-nonterminal">$P</span>:tt)+)<span class="question-mark">?</span>] <span class="kw">for </span><span class="macro-nonterminal">$V</span>:ty
        $( [ <span class="kw">where </span>$(<span class="macro-nonterminal">$constr</span>:tt)+ ])<span class="question-mark">?
        </span>{
            $( $(( $(<span class="macro-nonterminal">$flag</span>:ident)+ ))<span class="question-mark">? </span><span class="macro-nonterminal">$key</span>:ident : <span class="macro-nonterminal">$KEY</span>:ty $({ $(<span class="macro-nonterminal">$source</span>:tt)+ })<span class="question-mark">? </span>),+
            $(,)<span class="question-mark">?
        </span>}
} =&gt; { ... };
    { @access(<span class="macro-nonterminal">$ex</span>:expr, (<span class="prelude-ty">Option</span>) <span class="macro-nonterminal">$key</span>:ident : <span class="macro-nonterminal">$t</span>:ty ) } =&gt; { ... };
    { @access(<span class="macro-nonterminal">$ex</span>:expr, () <span class="macro-nonterminal">$key</span>:ident : <span class="macro-nonterminal">$t</span>:ty) } =&gt; { ... };
    { @access(<span class="macro-nonterminal">$ex</span>:expr, (<span class="prelude-ty">Option</span>) <span class="macro-nonterminal">$key</span>:ident : <span class="macro-nonterminal">$t</span>:ty { . <span class="macro-nonterminal">$field</span>:tt } ) } =&gt; { ... };
    { @access(<span class="macro-nonterminal">$ex</span>:expr, () <span class="macro-nonterminal">$key</span>:ident : <span class="macro-nonterminal">$t</span>:ty { . <span class="macro-nonterminal">$field</span>:tt } ) } =&gt; { ... };
    { @access(<span class="macro-nonterminal">$ex</span>:expr, (<span class="prelude-ty">Option</span>) <span class="macro-nonterminal">$key</span>:ident : <span class="macro-nonterminal">$t</span>:ty { <span class="macro-nonterminal">$func</span>:ident () } ) } =&gt; { ... };
    { @access(<span class="macro-nonterminal">$ex</span>:expr, () <span class="macro-nonterminal">$key</span>:ident : <span class="macro-nonterminal">$t</span>:ty { <span class="macro-nonterminal">$func</span>:ident () } ) } =&gt; { ... };
}</pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Declare a structure that can hold elements with multiple unique keys.</p>
<p>Each element can be looked up or removed by any of its keys. The keys
themselves can be any type that supports <code>Hash</code>, <code>Eq</code>, and <code>Clone</code>. Elements
can have multiple keys of the same type: for example, a person can have a
username <code>String</code> and an irc_handle <code>String</code>.</p>
<p>All keys in the set must be unique: if a new element is inserted that has
the same value for any key as a previous element, the old element is
removed.</p>
<p>Keys may be accessed from elements either by field access or by an accessor
function.</p>
<p>Keys may be optional.  If all keys are optional, then we require
additionally that every element must have at least one key.</p>
<h2 id="examples"><a href="#examples">Examples</a></h2>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>tor_basic_utils::n_key_set;

<span class="comment">// We declare a person struct with several different fields.
</span><span class="kw">pub struct </span>Person {
    username: String,
    irc_handle: String,
    student_id: <span class="prelude-ty">Option</span>&lt;u64&gt;,
    favorite_joke: <span class="prelude-ty">Option</span>&lt;String&gt;,
}

<span class="macro">n_key_set! </span>{
    <span class="kw">pub struct </span>PersonSet <span class="kw">for </span>Person {
        <span class="comment">// See note on &quot;Key syntax&quot; below.  The &quot;.foo&quot; syntax
        // here means that the value for the key is returned
        // by accessing a given field.
        </span>username: String { .username },
        irc_handle: String { .irc_handle },
        (<span class="prelude-ty">Option</span>) student_id: u64 { .student_id }
    }
}

<span class="kw">let </span><span class="kw-2">mut </span>people = PersonSet::new();
people.insert(Person {
    username: <span class="string">&quot;mina&quot;</span>.into(),
    irc_handle: <span class="string">&quot;pashMina&quot;</span>.into(),
    student_id: <span class="prelude-val">None</span>,
    favorite_joke: <span class="prelude-val">None
</span>});
<span class="macro">assert!</span>(people.by_username(<span class="string">&quot;mina&quot;</span>).is_some());
<span class="macro">assert!</span>(people.by_irc_handle(<span class="string">&quot;pashMina&quot;</span>).is_some());</code></pre></div>
<h2 id="key-syntax"><a href="#key-syntax">Key syntax</a></h2>
<p>You can tell the map to access the keys of an element in any of several ways.</p>
<ul>
<li><code>name : type { func() }</code> - A key whose name is <code>name</code> and type is <code>type</code>,
that can be accessed from a given element by calling <code>element.func()</code>.</li>
<li><code>name : type { .field }</code> - A key whose name is <code>name</code> and type is <code>type</code>,
that can be accessed from a given element by calling <code>&amp;element.field</code>.</li>
<li><code>name : type</code> - Short for as <code>name : type { name() }</code>.</li>
</ul>
<p>If a key declaration is preceded with <code>(Option)</code>, then the
key is treated as optional, and accessor functions are expected to return
<code>Option&lt;&amp;Type&gt;</code>.</p>
<h2 id="additional-features"><a href="#additional-features">Additional features</a></h2>
<p>You can put generic parameters and <code>where</code> constraints on your structure.
The <code>where</code> clause (if present) must be wrapped in square brackets.</p>
<p>If you need to use const generics or lifetimes in your structure, you
need to use square brackets instead of angle brackets, and specify both the
generic parameters <em>and</em> the type that you are implementing. (This is due to
limitations in the Rust macro system.)  For example:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="macro">n_key_set!</span>{
    <span class="kw">struct</span>[<span class="lifetime">&#39;a</span>, T, <span class="kw">const </span>N: usize] ArrayMap2[<span class="lifetime">&#39;a</span>, T, N] <span class="kw">for </span>(String, [<span class="kw-2">&amp;</span><span class="lifetime">&#39;a </span>T;N])
        [ <span class="kw">where </span>T: Clone + <span class="lifetime">&#39;a </span>]
    {
         name: String { .<span class="number">0 </span>}
    }
}</code></pre></div>
</div></details></section></div></main></body></html>